const questionBank = {
  "30th May 2025 - Shift1": [
    {
    "q": "With the onset of monsoons, day temperature:",
    "options": [
      "1. increases owing to the flow of hot winds",
      "2. decreases owing to cloudiness and rainfall",
      "3. does not vary much",
      "4. decreases owing to snowfall in the north"
    ],
    "answer": 1
  },
  {
    "q": "मानसून की शुरूआत के साथ, दिन के तापमान में क्या परिवर्तन आता है?",
    "options": [
      "1. गर्म हवाओं के प्रवाह के कारण बढ़ता है।",
      "2. बादल और वर्षा के कारण घटता है।",
      "3. विशेष परिवर्तन नहीं होता है।",
      "4. उत्‍तर में हिमपात के कारण घटता है।"
    ],
    "answer": 1
  },
  {
    "q": "Which of the following gases is NOT known as greenhouse gas?",
    "options": [
      "1. Methane",
      "2. Carbon dioxide",
      "3. Nitrous oxide",
      "4. Hydrogen"
    ],
    "answer": 3
  },
  {
    "q": "निम्‍नलिखित में से किस गैस को ग्रीनहाउस गैस नहीं कहा जाता है?",
    "options": [
      "1. मेथेन",
      "2. कार्बन डाइऑक्साइड़",
      "3. नाइट्रस ऑक्साइड़",
      "4. हाइड्रोजन"
    ],
    "answer": 3
  },
  {
    "q": "The CERES principles are:",
    "options": [
      "1. codes for protection of salmon fisheries",
      "2. a set of voluntary environmental standards for business",
      "3. anti-pollution codes that were adopted at the first earth summit in 1992",
      "4. designed to eliminate the production of greenhouse gases"
    ],
    "answer": 1
  },
  {
    "q": "CERES सिद्धांत क्या हैं?",
    "options": [
      "1. सैल्‍मन मछली पालन की सुरक्षा हेतु नियमावली",
      "2. व्‍यवसाय हेतु पर्यावरण के स्वैच्छिक मानकों का समूह",
      "3. वर्ष 1992 के प्रथम पृथ्वी शिखर सम्मेलन में अंगीकृत की गई प्रदूषण-विरोधी नियमावली",
      "4. ग्रीनहाउस गैसों के उत्पादन को समाप्‍त करने हेतु निर्धारित सिद्धांत"
    ],
    "answer": 1
  },
  {
    "q": "How many pairs of legs is found in an insect?",
    "options": [
      "1. One pair",
      "2. Two pairs",
      "3. Three pairs",
      "4. Four pairs"
    ],
    "answer": 2
  },
  {
    "q": "कीटों (insect) में कितने जोड़ी पैर पाए जाते हैं?",
    "options": [
      "1. एक जोड़ी",
      "2. दो जोड़ी",
      "3. तीन जोड़ी",
      "4. चार जोड़ी"
    ],
    "answer": 2
  },
  {
    "q": "Who among the following was the founder of the Satya Shodhak Samaj?",
    "options": [
      "1. BR Ambedkar",
      "2. Jyotiba Phule",
      "3. Narayan Guru",
      "4. Ramasamy Naicker"
    ],
    "answer": 1
  },
  {
    "q": "सत्‍य शोधक समाज के संस्थापक निम्‍न में से कौन थे?",
    "options": [
      "1. बीआर अंबेडकर",
      "2. ज्योतिबा फुले",
      "3. नारायण गुरू",
      "4. रामस्वामी नाइकर"
    ],
    "answer": 1
  },
  {
    "q": "A writ issued by the judiciary enquiring upon the executive to do what it should have done within its stipulated powers is called: Options :",
    "options": [
      "1. Habeas corpus",
      "2. Mandamus",
      "3. Prohibition",
      "4. Quo Warranto"
    ],
    "answer": 1
  },
  {
    "q": "न्यायपालिका द्वारा जारी एक रिट जिसके द्वारा कार्यपालिका से उसकी निर्दिष्‍ट शक्तियों के भीतर किए जाने वाले कार्य के विषय में पूछा गया हो, निम्‍न में से क्या कहलाती है?",
    "options": [
      "1. बंदी प्रत्‍यक्षीकरण (Habeas corpus)",
      "2. परमादेश (Mandamus)",
      "3. निषेध (Prohibition)",
      "4. अधिकार पृच्छा (Quo Warranto)"
    ],
    "answer": 1
  }
  ],
  
  "31st May 2025 - Shift2": [
        {
    "q": "What type of climate does India experience?",
    "options": [
      "1. Monsoon Climate",
      "2. Tropical Rainforest Climate",
      "3. Desert Climate",
      "4. Mediterranean Climate"
    ],
    "answer": 0
  },
  {
    "q": "भारत में किस कार की जलवायु पाई जाती है?",
    "options": [
      "1. मानसून जलवायु",
      "2. उष्‍णकटिबंधीय वर्षावन जलवायु",
      "3. रेगिस्तानी जलवायु",
      "4. भूमध्‍यसागरीय जलवायु"
    ],
    "answer": 0
  },
  {
    "q": "In which of the following states is the lion-tailed macaque found in its natural habitat? \\n 1. Tamil Nadu \\n 2. Kerala \\n 3. Karnataka \\n 4. Andhra Pradesh",
    "options": [
      "1. Only 1, 2 and 3",
      "2. Only 2",
      "3. Only 1, 3 and 4",
      "4. 1, 2, 3 and 4"
    ],
    "answer": 0
  },
  {
    "q": "शेर जैसी पूंछ वाला मकाक बंदर निलिखित में से किन राज्यों में अपने प्राकृतिक आवास में पाया जाता है?\\n 1. तमिलनाडु  \\n 2. केरल \\n 3. कर्नाटक \\n 4. आंध्र प्रदेश",
    "options": [
      "1. केवल 1, 2 और 3",
      "2. केवल 2",
      "3. केवल 1, 3 और 4",
      "4. 1, 2, 3 और 4"
    ],
    "answer": 0
  },
  {
    "q": "Fishes die out of water because:",
    "options": [
      "1. they get more oxygen due to direct inhalation from the atmosphere",
      "2. the temperature of the body increases",
      "3. the supply of oxygen to the fish is reduced as they cannot respire using the oxygen present in the atmosphere",
      "4. they need water to move"
    ],
    "answer": 2
  },
  {
    "q": "मछलियां पानी से बाहर मर क्यों जाती हैं?",
    "options": [
      "1. प्रत्‍यक्ष श्‍वसन द्वारा उन्हें वातावरण से अधिक मात्रा में ऑक्सीजन मिलने लगती है।",
      "2. उनके शरीर का तापमान बढ़ जाता है।",
      "3. मछलियों को ऑक्सीजन की आपूर्ति कम हो जाती है क्योंकि वे वातावरण में मौजूद ऑक्सीजन का उपयोग करके सांस नहीं ले पाती हैं।",
      "4. उन्हें चलने के लिए पानी की आवश्‍यकता होती है।"
    ],
    "answer": 2
  },
  {
    "q": "A Red Herring Prospectus, or offer document, is filed by a company to the __________ when it plans to raise money from the public by selling shares of the company to investors. Options :",
    "options": [
      "1. RBI",
      "2. SEBI",
      "3. AMFI",
      "4. Registrar of Companies"
    ],
    "answer": 1
  },
  {
    "q": "कोई कंपनी जब निवेशकों को कंपनी के शेयर बेचकर जनता से धन जुटाने की योजना बनाती है, तो उस कंपनी द्वारा _________ को एक रेड हेरिंग प्रॉस्पेक्‍टस (Red Herring Prospectus), या प्रस्‍ताव दस्तावेज़ पेश (file) किया जाता है।",
    "options": [
      "1. RBI",
      "2. SEBI",
      "3. AMFI",
      "4. कंपनियों के रजिस्ट्रार"
    ],
    "answer": 1
  },
  {
    "q": "Which of the following Articles of the Directive Principles of State Policy deals with the promotion of international peace and security?",
    "options": [
      "1. 41",
      "2. 43 A",
      "3. 48 A",
      "4. 51"
    ],
    "answer": 3
  },
  {
    "q": "राज्‍य के नीति निदेशक सिद्धांतों का निम्‍नलिखित में से कौन-सा अनुच्छेद अंतरराष्ट्रीय शांति और सुरक्षा को बढ़ावा देने से संबंधित है?",
    "options": [
      "1. 41",
      "2. 43 A",
      "3. 48 A",
      "4. 51"
    ],
    "answer": 3
  },
  {
    "q": "Which of the following longitudes determines the Indian Standard Time?",
    "options": [
      "1. 85.5° E",
      "2. 86.5° E",
      "3. 84.5° E",
      "4. 82.5° E"
    ],
    "answer": 3
  },
  {
    "q": "निम्‍न में से कौन-सा देशांतर, भारतीय मानक समय को निर्धारित करता है?",
    "options": [
      "1. 85.5° E",
      "2. 86.5° E",
      "3. 84.5° E",
      "4. 82.5° E"
    ],
    "answer": 3
  }
  ]
};


let currentQuestions = [];
let langOffset = 1;

window.onload = function () {
  const examDateSelect = document.getElementById('examDate');
  for (let date in questionBank) {
    const option = document.createElement('option');
    option.value = date;
    option.textContent = date;
    examDateSelect.appendChild(option);
  }
};

function startTest() {
  const name = document.getElementById('username').value.trim();
  const date = document.getElementById('examDate').value;
  const lang = document.getElementById('language').value;

  if (name === '' || date === '') {
    alert("कृपया नाम और परीक्षा दिनांक भरें।");
    return;
  }

  langOffset = lang === "hindi" ? 1 : 0;
  const allQuestions = questionBank[date];
  currentQuestions = allQuestions;
  renderQuestions(allQuestions);
}

function renderQuestions(allQuestions) {
  document.getElementById('setupForm').style.display = 'none';
  document.getElementById("langSwitch").style.display = "block";
  const testArea = document.getElementById("testArea");
  const quizDiv = document.createElement('div');
  quizDiv.id = "quizBox";

  for (let i = 0; i < allQuestions.length; i += 2) {
    const qDiv = document.createElement('div');
    qDiv.className = 'question-block';
    qDiv.id = `question-block-${i}`;

    qDiv.innerHTML = `<p id="qtext-${i}"><b>प्रश्न ${i / 2 + 1}:</b> ${allQuestions[i + langOffset].q}</p>`;

    allQuestions[i + langOffset].options.forEach((opt, idx) => {
      const inputName = `q${i}`;
      const optionId = `q${i}_opt${idx}`;
      qDiv.innerHTML += `
        <label id="optlabel-${i}-${idx}">
          <input type="radio" name="${inputName}" value="${idx}"> ${opt}
        </label><br>`;
    });

    quizDiv.appendChild(qDiv);
  }

  quizDiv.innerHTML += `<br><button onclick="submitAnswers()">✅ सबमिट करें</button>`;
  testArea.appendChild(quizDiv);
}

function updateLanguage() {
  const lang = document.getElementById("language").value;
  langOffset = lang === "hindi" ? 1 : 0;

  for (let i = 0; i < currentQuestions.length; i += 2) {
    const question = currentQuestions[i + langOffset];
    document.getElementById(`qtext-${i}`).innerHTML = `<b>प्रश्न ${i / 2 + 1}:</b> ${question.q}`;
    question.options.forEach((opt, idx) => {
      const label = document.getElementById(`optlabel-${i}-${idx}`);
      if (label) {
        label.lastChild.textContent = ` ${opt}`;
      }
    });
  }
}

function submitAnswers() {
  let total = 6, score = 0, unansweredIndex = -1;

  for (let i = 0; i < currentQuestions.length; i += 2) {
    const radios = document.getElementsByName(`q${i}`);
    let answered = false;
    for (let r of radios) if (r.checked) answered = true;
    if (!answered && unansweredIndex === -1) unansweredIndex = i;
  }

  if (unansweredIndex !== -1) {
    alert("कृपया सभी 06 प्रश्नों के उत्तर दें।");
    const target = document.getElementsByName(`q${unansweredIndex}`)[0];
    if (target) {
      target.scrollIntoView({ behavior: 'smooth', block: 'center' });
      target.focus();
    }
    return;
  }

  for (let i = 0; i < currentQuestions.length; i += 2) {
    const radios = document.getElementsByName(`q${i}`);
    let selected = -1;
    for (let r of radios) if (r.checked) selected = parseInt(r.value);
    const correctAns = currentQuestions[i + langOffset].answer;

    radios.forEach((radio, idx) => {
      const label = radio.parentElement;
      if (idx === correctAns) {
        label.style.color = "green";
        label.style.fontWeight = "bold";
      }
      if (radio.checked && idx !== correctAns) {
        label.style.color = "red";
        label.style.fontWeight = "bold";
        const correctText = currentQuestions[i + langOffset].options[correctAns];
        const correctDiv = document.createElement("div");
        correctDiv.style.color = "green";
        correctDiv.innerHTML = `✔ सही उत्तर: ${correctText}`;
        label.parentElement.appendChild(correctDiv);
      }
      if (radio.checked && idx === correctAns) score++;
      radio.disabled = true;
    });
  }

 
  
  const scoreBox = document.createElement("div");
  scoreBox.innerHTML = `<h3>📊 आपका स्कोर: ${score} / ${total}</h3>`;
  scoreBox.style.background = "#dff0d8";
  scoreBox.style.padding = "10px";
  scoreBox.style.marginTop = "20px";
  scoreBox.style.borderRadius = "8px";
  document.getElementById("quizBox").appendChild(scoreBox);
  const name = document.getElementById("username").value;
  const examDate = document.getElementById("examDate").value;
  saveToGoogleSheet(name, examDate, score);

  const quizBox = document.getElementById("quizBox");
  const oldBtn = quizBox.querySelector("button");
  if (oldBtn) oldBtn.remove();

  const retryBtn = document.createElement("button");
  retryBtn.textContent = "🔄 अन्य टेस्ट दें";
  retryBtn.onclick = () => location.reload();
  retryBtn.style.marginTop = "15px";
  retryBtn.style.background = "#e91e63";
  retryBtn.style.color = "#fff";
  retryBtn.style.border = "none";
  retryBtn.style.padding = "10px";
  retryBtn.style.borderRadius = "6px";
  retryBtn.style.fontWeight = "bold";
  quizBox.appendChild(retryBtn);
}
  
  function saveToGoogleSheet(name, examDate, score) {
  const url = "https://script.google.com/macros/s/AKfycbze217vEXKA0PSGSa0Et7e9-bNhgNhNq_bCLES3wKfL8ZxUdt4JyHnp3LAJ-_rRgmmCEw/exec"; 

  const formData = new FormData();
  formData.append("name", name);
  formData.append("examDate", examDate);
  formData.append("score", score);

  fetch(url, {
    method: "POST",
    body: formData
  })
  .then(res => res.text())
  .then(data => {
    console.log("✅ Google Sheet में सेव:", data);
  })
  .catch(err => {
    console.error("❌ Error:", err);
  });
}
  
